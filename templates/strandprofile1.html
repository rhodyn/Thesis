<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href='../static/index-style1.css';>
    <style>
        body {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>

</head>
<body>
    <div>
    <a href="/logout" class="header-link">
        <img src="../static/Images/arrow-home.png"><i>Home</i></a>
    </div>
        <div class="fixed-nav">
            <a href="#" class="nav-item-active">
                <img src="../static/Images/profile-active.png" class="nav-icon" alt="Profile Icon"> Profiling
            </a>
            <a class="nav-item">
                <img src="../static/Images/hobbies-na.png" class="nav-icon" alt="Hobbies Icon"> Hobbies, Interest, and Career Aspirations
            </a>
            <a class="nav-item">
                <img src="../static/Images/grades-na.png" class="nav-icon" alt="Grades Icon"> Grades & Exam Results
            </a>
            <a class="nav-item">
                <img src="../static/Images/personality-na.png" class="nav-icon" alt="Personality Test Icon"> Personality Test
            </a>
            <a class="nav-item">
                <img src="../static/Images/results-na.png" class="nav-icon" alt="Results Icon"> Results
            </a>
        </div>
    
    <div style="margin-left: 250px; padding: 50px;">
        <h1>Profiling</h1>
    </div>
    <div class="container-form">
        <form id="custom-form" method="post">
            <div class="flex-container">
                <div class="main-page-strand" id="checkbox1">
                <h2 align="center">Senior High School Strand</h2>
                <br>
                    <div class="strand-box" data-value="ABM" data-selectable>ABM</div>
                    <div class="strand-box" data-value="STEM" data-selectable>STEM</div>
                    <div class="strand-box" data-value="HUMSS" data-selectable>HUMSS</div>
                    <div class="strand-box" data-value="GAS" data-selectable>GAS</div>
                    <div class="strand-box" data-value="TVL - Home Economics" data-selectable>TVL - Home Economics</div>
                    <div class="strand-box" data-value="TVL - ICT" data-selectable>TVL - ICT</div>
                </div>
                <input type="hidden" name="selectedStrand" id="selectedStrand">
                
                <br>
                <div class="main-page-two">
                    <h2 align="center">Grade Level</h2><br>
                    <div class="grade-container" id="checkbox2">
                        <div class="grade" data-value="Grade 11" data-selectable>Grade 11</div>
                        <div class="grade" data-value="Grade 12" data-selectable>Grade 12</div>
                    </div><br><br>
                
                    <input type="hidden" name="selectedGrade" id="selectedGrade">
            
                    <h2 align="center">Age</h2><br>
                    <div class="age-container">
                        <label for="ageSelect"></label>
                        <select class="form-select" id="ageSelect" name="selectedAge">
                            <option value="">Select Age</option>
                            <option value="15 and below">15 years old and below</option>
                            <option value="16">16 years old</option>
                            <option value="17">17 years old</option>
                            <option value="18">18 years old</option>
                            <option value="19">19 years old</option>
                            <option value="20 and above">20 years old and above</option>
                        </select>
                    </div><br>
            
                    <input type="hidden" name="selectedAge" id="selectedAge"><br>

                    <h2 align="center">Gender</h2>
                    <div class="gender-container">
                        <label for="genderSelect"></label>
                        <select class="form-select" id="genderSelect" name="selectedGender">
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select><br>
                    </div>
            
                    <input type="hidden" name="selectedGender" id="selectedGender"><br>
                </div>
                <br>

                <div class="main-page-three">
                    <h1 align="center">Monthly Household Gross Income</h1>
                    <div class="income-container">
                        <label for="incomeSelect"></label><br><br>
                        <select class="form-select" id="incomeSelect" name="selectedIncome">
                            <option value="">Select Monthly Household Gross Income</option>
                            <option value="Below 12,100">₱12,100 and below</option>
                            <option value="12,101 - 24,200">₱12,101 - below ₱24,200</option>
                            <option value="24,201 - 36,300">₱24,201 - below ₱36,300</option>
                            <option value="36,301 - 48,400">₱36,301 - below ₱48,400</option>
                            <option value="48,401 - 84,600">₱48,401 - below ₱84,600</option>
                            <option value="84,601 - 145,000">₱84,601 - below ₱145,000</option>
                            <option value="145,001 - 241,700">₱145,001 - below ₱241,700</option>
                            <option value="241,701">₱241,701 and above</option>
                        </select><br><br><br><br><br><br><br><br>
                    </div>
                    <input type="hidden" name="selectedIncome" id="selectedIncome"><br>
                </div><br>
            </div><br>
        <button style="display: block; margin-left: 45%; width: 20%;" type="submit" class="btn btn-danger" onclick="submitForm()">Next</button>
        </form>
    </div>

    <script>
        const strandBoxes = document.querySelectorAll('.strand-box');
        const gradeBoxes = document.querySelectorAll('.grade');

        strandBoxes.forEach(box => {
            box.addEventListener('click', function() {
                strandBoxes.forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedStrandInput.value = this.getAttribute('data-value');
            });
        });

        gradeBoxes.forEach(box => {
            box.addEventListener('click', function() {
                gradeBoxes.forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedGradeInput.value = this.getAttribute('data-value');
            });
        });

        function setupCheckboxListeners(groupClass) {
            document.querySelectorAll('.' + groupClass).forEach(div => {
                div.addEventListener('click', function () {
                this.parentElement.querySelectorAll('.' + groupClass).forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                });
            });
        }

        setupCheckboxListeners('strand-box');
        setupCheckboxListeners('grade');

        function getSelectedDivValue(groupId, groupClass) {
            const selected = document.querySelector(`#${groupId} .${groupClass}.selected`);
            return selected ? selected.getAttribute('data-value') : null;
        }

        function submitForm() {
            const checkbox1 = getSelectedDivValue('checkbox1', 'strand-box');
            const checkbox2 = getSelectedDivValue('checkbox2', 'grade');

            const select1 = document.getElementById('ageSelect').value;
            const select2 = document.getElementById('genderSelect').value;
            const select3 = document.getElementById('incomeSelect').value;

            const resultArray = [checkbox1, checkbox2, select1, select2, select3];

            const form = document.createElement("form");
            form.method = "POST";
            form.action = "/strandprofile";

            const input = document.createElement("input");
            input.type = "hidden";
            input.name = "user_data";
            input.value = JSON.stringify(resultArray);

            form.appendChild(input);
            document.body.appendChild(form);
            form.submit();
        }

        document.getElementById('custom-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const selectedStrand = selectedStrandInput.value;
            const selectedGrade = selectedGradeInput.value;
            const selectedGender = genderSelect.value;
            const selectedIncome = incomeSelect.value;
            const selectedAge = ageSelect.value;

            if (selectedStrand && selectedGrade && selectedGender && selectedAge && selectedIncome) {
                submitForm();
            } else {
                alert('Please select a strand, a grade, a gender, a gross monthly income, and an age before submitting.');
            }
        });
    </script>
</body>
</html>